@model Models.Inventory
@{
    Layout = null;
}
<!DOCTYPE html>
<html>
<head>
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title></title>
    <link href="~/Content/AdminIndex/css/app.min.css" rel="stylesheet" />
    <link href="~/Content/AdminIndex/css/icons.min.css" rel="stylesheet" />
    <script src="~/Content/AdminIndex/js/app.min.js"></script>
    <link href="~/Content/layui/css/layui.css" rel="stylesheet" media="all" />
    <script src="~/Content/layui/layui.js" charset="utf-8"></script>
    <script type="text/javascript">
        function add() {



            $.ajax({
                url: "@Url.Action("OutCome_add")",
                type: "post",
                data: $("form").serialize(),
                dataType: "json",
                success: function (data) {
                    data = eval("(" + data + ")");
                    if (data) {
                        alert("出库成功");
                        parent.closeWin2();
                        parent.openFrame("Inventory_list");
                    } else {
                        alert("出库失败");
                        parent.closeWin2();
                        parent.openFrame("Inventory_list");
                    }
                }
            });
        }
    </script>
</head>
<body>
    @{
        Models.Inventory inventory = (Models.Inventory)ViewData["Inventory"];
        List<Models.Employee> employee = (List<Models.Employee>)ViewData["employee"];
        string name = (string)ViewData["name"];
        List<Models.Project> project = (List<Models.Project>)ViewData["project"];
    }
    <section class="signin popup-in">
        <div class="container">
            <div class="sign-content popup-in-content">
                <div class="popup-in-txt">
                    <h2>新增出库</h2>
                    <div class="row">
                        <div class="col-12">
                            <div class="signin-form">
                                @using (Html.BeginForm("OutCome_add", "Inventory", new { ReturnUrl = ViewBag.ReturnUrl }, FormMethod.Post, new { @role = "form" }))
                                {
                                    <div class="form-row">
                                        <div class="form-group col-md-6">
                                            <label for="signin_form">材料名称：</label>
                                            @Html.TextBox("name", @Models.Inventory.GetNameName(inventory.incomeId), new { @readonly = "readonly", @class = "form-control", type = "text" })
                                        </div>
                                        <div class="form-group col-md-6">
                                            <label for="signin_form">材料规格：</label>
                                            @Html.TextBox("ModelName", Models.Inventory.GetModelName(inventory.incomeId), new { @readonly = "readonly", @class = "form-control", type = "text" })
                                        </div>
                                    </div>
                                    <div class="form-row">
                                        <div class="form-group col-md-6">
                                            <label for="signin_form">材料编号：</label>
                                            @Html.TextBox("CodeName", Models.Inventory.GetMaterCodeName(inventory.incomeId), new { @readonly = "readonly", @class = "form-control", type = "text" })
                                        </div>
                                        <div class="form-group col-md-6">
                                            <label for="example-date">出库时间：</label>
                                            <input class="form-control" name="date" value="@Models.Inventory.NewDateTime()">
                                        </div>
                                    </div>
                                    <div class="form-row">
                                        <div class="form-group col-md-6">
                                            <label for="signin_form">出库数量：</label>
                                            @Html.TextBox("number", inventory.amount, new { @class = "form-control", type = "number" })
                                        </div>
                                        <div class="form-group col-md-6">
                                            <label for="signin_form">货品单位：</label>
                                            @Html.DropDownListFor(m => m.unit, ViewBag.select as SelectList, new { @class = "form-control", id = "example-select" })
                                        </div>
                                    </div>
                                    <div class="form-row">
                                        <div class="form-group col-md-6">
                                            <label for="signin_form">操作人：</label>
                                            @Html.TextBox("Name", @name, new { @readonly = "readonly", @class = "form-control", type = "text" })
                                        </div>
                                        <div class="form-group col-md-6">
                                            <label for="signin_form">领用人：</label>
                                            @*<select class="form-control" name="employeeName">
                                                @foreach (var emp in employee)
                                                {
                                                    <option value="@emp.id">姓名：@emp.name  工号：@emp.number  部门：@Models.Department.GetDepartment(emp.departmentId.Value).departmentName</option>
                                                }
                                            </select>*@
                                            <input id="employeeName" name="employeeName" list="codelist" style="width:350px;height:40px" class="form-control" placeholder="请选择或输入领用人" />
                                            <datalist id="codelist">
                                                @foreach (var emp in employee)
                                                {
                                                <option>姓名：@emp.name  工号：@emp.number  部门：@Models.Department.GetDepartment(emp.departmentId.Value).departmentName</option>
                                                }
                                            </datalist>
                                        </div>
                                    </div>
                                    <div class="form-row">
                                        <div class="form-group col-md-6">
                                            <label for="signin_form">项目令号：</label>
                                            <select class="form-control" name="project">
                                                @foreach (var pro in project)
                                                {
                                                    <option value="@pro.id">令号：@pro.projectCode      名称：@pro.projectName</option>
                                                }
                                            </select>
                                        </div>

                                    </div>
                                }
                            </div>
                            <div class="row">
                                <div class="col-12">
                                    <div class="card">
                                        <div class="card-body" >
                                            <h4 class="header-title">备注：</h4>
                                            <form method="post" action="/Inventory/OutCome_add">
                                                <textarea id="instructions" name="instructions" style=" width: 99%; height: 90px" placeholder="请输入详细描述......."></textarea>
                                            </form>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row" align="center">
                        <div class="col-sm-12">
                            <div class="signin-footer">
                                <button type="button" name="but" class="btn btn-primary" onclick="add();" style="width:200px;height:50px">
                                    出库
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
</body>
</html>